 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 1 - 2019/05/03 17時09分30秒


       1/       0 :                     ;-----------------------------------------------------------------------
       2/       0 :                     ; Z80 Monitor KUNI-NET
       3/       0 :                     ;-----------------------------------------------------------------------
       4/       0 :                     
       5/       0 :                     
       6/       0 : =DH                 CR		EQU	0DH
       7/       0 : =AH                 LF		EQU	0AH
       8/       0 : =1BH                ESC		EQU	1BH
       9/       0 : =3H                 CTRLC	EQU	03H
      10/       0 : =CH                 CLS		EQU	0CH
      11/       0 : =20H                SPC		EQU	20h
      12/       0 : =0H                 NULL	EQU 00h
      13/       0 : =7H                 BEEP	EQU 07h
      14/       0 : =8H                 BS		EQU 08h
      15/       0 : =9H                 TAB		EQU 09h
      16/       0 : =7FH                DEL		EQU 7Fh
      17/       0 :                     
      18/       0 :                     
      19/       0 : =>DEFINED              IFNDEF i8259_8254
      20/       0 :                     		ORG	0000h
      21/       0 :                     ;------------------------------------------------------------------------------
      22/       0 :                     ; RST00 リセット
      23/       0 :                     ;------------------------------------------------------------------------------
      24/       0 :                     RST00		DI		
      25/       0 :                     		JP	INIT	
      26/       0 :                     
      27/       0 :                     ;------------------------------------------------------------------------------
      28/       0 :                     ; RST08 1文字送信
      29/       0 :                     ;------------------------------------------------------------------------------
      30/       0 :                     	ORG	0008H
      31/       0 :                     RST08		JP	COUT
      32/       0 :                     
      33/       0 :                     ;------------------------------------------------------------------------------
      34/       0 :                     ; RST10 1文字受信
      35/       0 :                     ;------------------------------------------------------------------------------
      36/       0 :                     	ORG	0010H
      37/       0 :                     RST10		JP	CIN
      38/       0 :                     
      39/       0 :                     ;------------------------------------------------------------------------------
      40/       0 :                     ; RST18 入力バッファチェック
      41/       0 :                     ;------------------------------------------------------------------------------
      42/       0 :                     	ORG	0018H
      43/       0 :                     RST18		JP	CKINCHAR
      44/       0 :                     
      45/       0 :                     ;------------------------------------------------------------------------------
      46/       0 :                     ; RST38 シリアル割り込みルーチン
      47/       0 :                     ;------------------------------------------------------------------------------
      48/       0 :                     	ORG	0038H
      49/       0 :                     RST38:	JP	SERINT 
      50/       0 :                     ;
      51/       0 :                     ;
      52/       0 : [19]                   ENDIF
      53/       0 :                     
      54/       0 : =>DEFINED              IFDEF i8259_8254
      55/       0 :                     		ORG	0000h
      56/       0 :                     ;------------------------------------------------------------------------------
      57/       0 :                     ; RST00 リセット
      58/       0 :                     ;------------------------------------------------------------------------------
      59/       0 : F3                  RST00		DI		
      60/       1 : C3 DC 06            		JP	INIT	
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 2 - 2019/05/03 17時09分30秒


      61/       4 :                     
      62/       4 :                     ;------------------------------------------------------------------------------
      63/       4 :                     ; RST08 1文字送信
      64/       4 :                     ;------------------------------------------------------------------------------
      65/       8 :                     	ORG	0008H
      66/       8 : C3 04 40            RST08		JP	RST08HOOK
      67/       B :                     
      68/       B :                     ;------------------------------------------------------------------------------
      69/       B :                     ; RST10 1文字受信
      70/       B :                     ;------------------------------------------------------------------------------
      71/      10 :                     	ORG	0010H
      72/      10 : C3 08 40            RST10		JP	RST10HOOK
      73/      13 :                     
      74/      13 :                     ;------------------------------------------------------------------------------
      75/      13 :                     ; RST18 入力バッファチェック
      76/      13 :                     ;------------------------------------------------------------------------------
      77/      18 :                     	ORG	0018H
      78/      18 : C3 0C 40            RST18		JP	RST18HOOK
      79/      1B :                     
      80/      1B :                     ;------------------------------------------------------------------------------
      81/      1B :                     ; RST20 PIT1 INT
      82/      1B :                     ;------------------------------------------------------------------------------
      83/      20 :                     	ORG	0020H
      84/      20 : C3 10 40            RST20		JP	RST20HOOK
      85/      23 :                     
      86/      23 :                     ;------------------------------------------------------------------------------
      87/      23 :                     ; RST28 PIT0 INT
      88/      23 :                     ;------------------------------------------------------------------------------
      89/      28 :                     	ORG	0028H
      90/      28 : C3 14 40            RST28		JP	RST28HOOK
      91/      2B :                     
      92/      2B :                     ;------------------------------------------------------------------------------
      93/      2B :                     ; RST38 シリアル割り込みルーチン
      94/      2B :                     ;------------------------------------------------------------------------------
      95/      38 :                     	ORG	0038H
      96/      38 : C3 1C 40            RST38:	JP	RST38HOOK 
      97/      3B :                     ;
      98/      3B :                     ;
      99/      3B : [54]                   ENDIF
     100/      3B :                     
     101/     100 :                     	ORG 0100h
     102/     100 :                     
     103/     100 :                     ;==============================================================================
     104/     100 :                     
     105/     100 :                     ;--------------------------------------------------------------------------------
     106/     100 :                     ; メイン
     107/     100 :                     ;--------------------------------------------------------------------------------
     108/     100 :                     MAIN:
     109/     100 : 21 CB 04                LD HL,OPENMSG
     110/     103 : CD A5 01                CALL STRPR
     111/     106 :                     _MAIN_LOOP:
     112/     106 : 21 06 01            	LD HL,_MAIN_LOOP
     113/     109 : E5                  	PUSH HL
     114/     10A :                     ;
     115/     10A : 3E 3E                   LD A,'>'
     116/     10C : CF                      RST 08h
     117/     10D : DD 21 91 04             LD IX,CMD_TBL
     118/     111 : CD 3E 01            	CALL GETC
     119/     114 : CF                      RST 08H
     120/     115 :                     ;
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 3 - 2019/05/03 17時09分30秒


     121/     115 :                     _CMD_LOOP:
     122/     115 : F5                  	PUSH AF
     123/     116 : DD 7E 00                LD A,(IX+0)
     124/     119 : B7                  	OR A
     125/     11A : 28 14               	JR Z,_ERROR_EXIT
     126/     11C : 47                  	LD B,A
     127/     11D : F1                  	POP AF
     128/     11E : B8                      CP B
     129/     11F : 20 07               	JR NZ,_NEXT_CMD
     130/     121 : DD 6E 01                LD L,(IX+1)
     131/     124 : DD 66 02            	LD H,(IX+2)
     132/     127 : E9                  	JP (HL)
     133/     128 :                     ;
     134/     128 :                     _NEXT_CMD:
     135/     128 : DD 23               	INC IX
     136/     12A : DD 23               	INC IX
     137/     12C : DD 23               	INC IX
     138/     12E : 18 E5               	JR _CMD_LOOP
     139/     130 :                     ;;
     140/     130 :                     _ERROR_EXIT
     141/     130 : F1                  	POP AF
     142/     131 : CD B4 01            	CALL CRLF_PRINT
     143/     134 : 21 1F 06            	LD HL,HATENA_MSG
     144/     137 : CD A5 01            	CALL STRPR
     145/     13A : CD B4 01            	CALL CRLF_PRINT
     146/     13D : C9                  	RET
     147/     13E :                     
     148/     13E :                     
     149/     13E :                     ;------------------------------------------------------------------------------
     150/     13E :                     ; 1文字入力 英字大文字対応
     151/     13E :                     ;------------------------------------------------------------------------------
     152/     13E :                     GETC:
     153/     13E : D7                      RST 10h
     154/     13F : FE 61                   CP 'a'
     155/     141 : F8                      RET M
     156/     142 : FE 7B                   CP 'z'+1
     157/     144 : F0                      RET P
     158/     145 : D6 20                   SUB A,20H
     159/     147 : C9                      RET
     160/     148 :                     
     161/     148 :                     ;------------------------------------------------------------------------------
     162/     148 :                     ; 文字列入力 エコーバックつき
     163/     148 :                     ;------------------------------------------------------------------------------
     164/     148 :                     STRIN:
     165/     148 :                     ; INBUF クリア
     166/     148 : 3E 00                   LD A,00H
     167/     14A : 32 66 40                LD (INBUF),A
     168/     14D : 21 66 40                LD HL,INBUF
     169/     150 : 11 67 40                LD DE,INBUF+1
     170/     153 : 01 3C 00                LD BC,INMAX
     171/     156 : ED B0                   LDIR
     172/     158 :                     ;
     173/     158 : 21 66 40                LD HL,INBUF
     174/     15B :                     ;
     175/     15B :                     _STRIN_LOOP:
     176/     15B : CD 3E 01                CALL GETC
     177/     15E : FE 0D                   CP 0Dh
     178/     160 : 28 3F                   JR Z,_STRIN_END
     179/     162 : FE 08                   CP BS
     180/     164 : 28 23                   JR Z,_BS_RTN
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 4 - 2019/05/03 17時09分30秒


     181/     166 : FE 7F               	CP DEL
     182/     168 : 28 1F                   JR Z,_BS_RTN
     183/     16A : FE 1B               	CP ESC
     184/     16C : 28 19               	JR Z,_ESC_RTN
     185/     16E :                     ;
     186/     16E :                     ; バッファENDにきた?
     187/     16E : 47                  	LD B,A
     188/     16F : 11 A2 40            	LD DE,INEND
     189/     172 : 7A                  	LD A,D
     190/     173 : BC                  	CP H
     191/     174 : 20 05               	JR NZ,_CHAR_SET
     192/     176 : 7B                  	LD A,E
     193/     177 : BD                  	CP L
     194/     178 : 28 08               	JR Z,_WARN_BEEP
     195/     17A : 78                  	LD A,B
     196/     17B :                     _CHAR_SET:
     197/     17B : 77                      LD (HL),A
     198/     17C : 23                      INC HL
     199/     17D : CD AE 01                call CPRINT
     200/     180 : 18 D9                   JR _STRIN_LOOP
     201/     182 :                     ;
     202/     182 :                     _WARN_BEEP:
     203/     182 : 3E 07               	LD A,BEEP
     204/     184 : CF                  	RST 08h
     205/     185 : 18 D4                   JR _STRIN_LOOP
     206/     187 :                     ;
     207/     187 :                     _ESC_RTN:
     208/     187 : 3F                  	CCF
     209/     188 : C9                  	RET
     210/     189 :                     ;
     211/     189 :                     _BS_RTN:
     212/     189 : 11 66 40            	LD DE,INBUF
     213/     18C : 7A                  	LD A,D
     214/     18D : BC                  	CP H
     215/     18E : 20 04               	JR NZ,_BS_RTN2
     216/     190 : 7B                  	LD A,E
     217/     191 : BD                  	CP L
     218/     192 : 28 EE               	JR Z,_WARN_BEEP
     219/     194 :                     ;
     220/     194 :                     _BS_RTN2:
     221/     194 : E5                      PUSH HL
     222/     195 : 21 EE 04                LD HL,BSTXT
     223/     198 : CD A5 01                CALL STRPR
     224/     19B : E1                      POP HL
     225/     19C : 2B                      DEC HL
     226/     19D : 36 00                   LD (HL),00h
     227/     19F : 18 BA                   JR _STRIN_LOOP
     228/     1A1 :                     ;
     229/     1A1 :                     _STRIN_END:
     230/     1A1 : CD B4 01                CALL CRLF_PRINT
     231/     1A4 : C9                      RET
     232/     1A5 :                     
     233/     1A5 :                     ;------------------------------------------------------------------------------
     234/     1A5 :                     ; 文字列出力
     235/     1A5 :                     ;------------------------------------------------------------------------------
     236/     1A5 :                     STRPR:
     237/     1A5 : 7E                      LD A,(HL)
     238/     1A6 : B7                      OR A
     239/     1A7 : C8                      RET Z
     240/     1A8 : CD AE 01                CALL CPRINT
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 5 - 2019/05/03 17時09分30秒


     241/     1AB : 23                      INC HL
     242/     1AC : 18 F7                   JR STRPR
     243/     1AE :                     
     244/     1AE :                     ;------------------------------------------------------------------------------
     245/     1AE :                     ; 文字出力 (CRLF対応)
     246/     1AE :                     ; IN: A - キャラクタ
     247/     1AE :                     ; RET: なし
     248/     1AE :                     ;------------------------------------------------------------------------------
     249/     1AE :                     CPRINT:
     250/     1AE : FE 0D                   CP 0Dh
     251/     1B0 : 28 02                   JR Z,CRLF_PRINT
     252/     1B2 : CF                      RST 08h
     253/     1B3 : C9                      RET
     254/     1B4 :                     
     255/     1B4 :                     ;------------------------------------------------------------------------------
     256/     1B4 :                     ; CRLF出力 (CRLF対応)
     257/     1B4 :                     ;------------------------------------------------------------------------------
     258/     1B4 :                     CRLF_PRINT:
     259/     1B4 : 3E 0D                   LD A,0DH
     260/     1B6 : CF                      RST 08H
     261/     1B7 : 3E 0A                   LD A,0AH
     262/     1B9 : CF                      RST 08h
     263/     1BA : C9                      RET
     264/     1BB :                     
     265/     1BB :                     ;------------------------------------------------------------------------------
     266/     1BB :                     ; ブランク出力 
     267/     1BB :                     ;------------------------------------------------------------------------------
     268/     1BB :                     SPC_PRINT:
     269/     1BB : 3E 20                   LD A,SPC
     270/     1BD : CF                      RST 08H
     271/     1BE : C9                      RET
     272/     1BF :                     
     273/     1BF :                     ;------------------------------------------------------------------------------
     274/     1BF :                     ; Hex2桁出力
     275/     1BF :                     ;------------------------------------------------------------------------------
     276/     1BF :                     HEX2OUT:
     277/     1BF : C5                  	PUSH BC
     278/     1C0 : 47                  	LD B,A
     279/     1C1 : CB 3F               	SRL A
     280/     1C3 : CB 3F               	SRL A
     281/     1C5 : CB 3F               	SRL A
     282/     1C7 : CB 3F               	SRL A
     283/     1C9 : CD D4 01            	CALL _HEX_CNV_PR
     284/     1CC : 78                  	LD A,B
     285/     1CD : E6 0F               	AND 0Fh
     286/     1CF : CD D4 01            	CALL _HEX_CNV_PR
     287/     1D2 : C1                  	POP BC
     288/     1D3 : C9                  	RET
     289/     1D4 :                     ;
     290/     1D4 :                     _HEX_CNV_PR:	
     291/     1D4 : C6 90               	ADD A,90h
     292/     1D6 : 27                  	DAA
     293/     1D7 : CE 40               	ADC	A,40h
     294/     1D9 : 27                  	DAA
     295/     1DA : CF                  	RST 08h
     296/     1DB : C9                  	RET
     297/     1DC :                     
     298/     1DC :                     ;================================================================================
     299/     1DC :                     ; ヘルプ出力
     300/     1DC :                     ;================================================================================
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 6 - 2019/05/03 17時09分30秒


     301/     1DC :                     HELP_OUT:
     302/     1DC : 21 F2 04                LD HL,HELP_MSG
     303/     1DF : 18 05               	JR _PRINT_END
     304/     1E1 :                     ;
     305/     1E1 :                     ;================================================================================
     306/     1E1 :                     ; バージョン出力
     307/     1E1 :                     ;================================================================================
     308/     1E1 :                     VERSION_OUT:
     309/     1E1 : 21 B0 04                LD HL,VERMSG
     310/     1E4 : 18 00               	JR _PRINT_END
     311/     1E6 :                     ;
     312/     1E6 :                     ;--------------------------------------------------------------------------------
     313/     1E6 :                     ; メッセージ出力してメインへリターン
     314/     1E6 :                     ;--------------------------------------------------------------------------------
     315/     1E6 :                     _PRINT_END:
     316/     1E6 : CD B4 01            	CALL CRLF_PRINT
     317/     1E9 : CD A5 01                CALL STRPR
     318/     1EC : CD B4 01            	CALL CRLF_PRINT
     319/     1EF : C9                      RET
     320/     1F0 :                     
     321/     1F0 :                     ;--------------------------------------------------------------------------------
     322/     1F0 :                     ; HEX4桁出力
     323/     1F0 :                     ;--------------------------------------------------------------------------------
     324/     1F0 :                     HEX4OUT:
     325/     1F0 : F5                  	PUSH AF
     326/     1F1 : 7C                  	LD A,H
     327/     1F2 : CD BF 01            	CALL HEX2OUT
     328/     1F5 : 7D                  	LD A,L
     329/     1F6 : CD BF 01            	CALL HEX2OUT
     330/     1F9 : F1                  	POP AF
     331/     1FA : C9                  	RET
     332/     1FB :                     
     333/     1FB :                     ;--------------------------------------------------------------------------------
     334/     1FB :                     ; 入力行パース
     335/     1FB :                     ;--------------------------------------------------------------------------------
     336/     1FB :                     PARSER:
     337/     1FB :                     ; 編集エリア初期化
     338/     1FB : 21 A3 40            	LD HL,ARGC
     339/     1FE : 3E 00               	LD A,0
     340/     200 : 77                  	LD (HL),A
     341/     201 : 11 A4 40            	LD DE,ARGC+1
     342/     204 : 01 06 00            	LD BC,ARG_AREA_LEN-1
     343/     207 : ED B0               	LDIR
     344/     209 :                     ; 入力パラメーター パース開始
     345/     209 : 4F                  	LD C,A
     346/     20A : 21 65 40            	LD HL,INBUF-1
     347/     20D : DD 21 A4 40         	LD IX,ARGV_1
     348/     211 :                     ;
     349/     211 :                     _PARSE_LOOP:
     350/     211 : 23                  	INC HL
     351/     212 : 7E                  	LD A,(HL)
     352/     213 : FE 00               	CP NULL
     353/     215 : C8                  	RET Z
     354/     216 : FE 20               	CP SPC
     355/     218 : 28 F7               	JR Z,_PARSE_LOOP
     356/     21A : 0C                      INC C
     357/     21B : 79                  	LD A,C
     358/     21C : FE 04               	CP ARG_MAX+1
     359/     21E : 30 1B               	JR NC,_PARSE_ERR
     360/     220 : 32 A3 40            	LD (ARGC),A
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 7 - 2019/05/03 17時09分30秒


     361/     223 : DD 75 00            	LD (IX+0),L
     362/     226 : DD 74 01            	LD (IX+1),H
     363/     229 : DD 23               	INC IX
     364/     22B : DD 23               	INC IX
     365/     22D :                     _PARAM_LOOP:
     366/     22D : 23                  	INC HL
     367/     22E : 7E                  	LD A,(HL)
     368/     22F : FE 00               	CP NULL
     369/     231 : C8                  	RET Z
     370/     232 : FE 20               	CP SPC
     371/     234 : 20 F7               	JR NZ,_PARAM_LOOP
     372/     236 : 3E 00               	LD A,NULL
     373/     238 : 77                  	LD (HL),A
     374/     239 : 18 D6               	JR _PARSE_LOOP
     375/     23B :                     ;
     376/     23B :                     _PARSE_ERR:
     377/     23B : 3F                  	CCF
     378/     23C : C9                  	RET
     379/     23D :                     
     380/     23D :                     ;--------------------------------------------------------------------------------
     381/     23D :                     ; HEX 2桁キャラクタ → Aレジスタ
     382/     23D :                     ;--------------------------------------------------------------------------------
     383/     23D :                     HEX2BIN:
     384/     23D : C5                  	PUSH BC
     385/     23E : 7E                  	LD A,(HL)
     386/     23F : CD 57 02            	CALL _ATOBIN
     387/     242 : 38 11               	JR C,_HEX2BIN_EXIT
     388/     244 : CB 27               	SLA A
     389/     246 : CB 27               	SLA A
     390/     248 : CB 27               	SLA A
     391/     24A : CB 27               	SLA A
     392/     24C : 47                  	LD B,A
     393/     24D : 23                  	INC HL
     394/     24E : 7E                  	LD A,(HL)
     395/     24F : CD 57 02            	CALL _ATOBIN
     396/     252 : 38 01               	JR C,_HEX2BIN_EXIT
     397/     254 : 80                  	ADD A,B
     398/     255 :                     _HEX2BIN_EXIT:
     399/     255 : C1                  	POP BC
     400/     256 : C9                  	RET
     401/     257 :                     ;
     402/     257 :                     _ATOBIN:
     403/     257 : FE 30               	CP '0'
     404/     259 : D8                  	RET C
     405/     25A : FE 3A               	CP '9'+1
     406/     25C : 38 09               	JR C,_ATOBIN1
     407/     25E : FE 41               	CP 'A'
     408/     260 : D8                  	RET C
     409/     261 : FE 47               	CP 'F'+1
     410/     263 : 3F                  	CCF
     411/     264 : D8                  	RET C
     412/     265 : C6 09               	ADD A,09H
     413/     267 :                     _ATOBIN1:
     414/     267 : E6 0F               	AND 0Fh
     415/     269 : C9                  	RET
     416/     26A :                     ;
     417/     26A :                     
     418/     26A :                     ;--------------------------------------------------------------------------------
     419/     26A :                     ; 4バイト16進数文字列→バイナリ(HL)へ
     420/     26A :                     ;--------------------------------------------------------------------------------
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 8 - 2019/05/03 17時09分30秒


     421/     26A :                     HEX4BIN:
     422/     26A : CD 3D 02            	CALL HEX2BIN
     423/     26D : D8                  	RET C
     424/     26E : 57                  	LD D,A
     425/     26F : 23                  	INC HL
     426/     270 : CD 3D 02            	CALL HEX2BIN
     427/     273 : D8                  	RET C
     428/     274 : 5F                  	LD E,A
     429/     275 : D5                  	PUSH DE
     430/     276 : E1                  	POP HL
     431/     277 : C9                  	RET
     432/     278 :                     ;
     433/     278 :                     ;================================================================================
     434/     278 :                     ; メモリーダンプ
     435/     278 :                     ;================================================================================
     436/     278 :                     MEM_DUMP:
     437/     278 : CD BB 01                CALL SPC_PRINT
     438/     27B :                     ;
     439/     27B : CD 48 01                CALL STRIN
     440/     27E : CD FB 01            	CALL PARSER
     441/     281 : 38 41               	JR C,_PARAM_ERR
     442/     283 :                     ; 入力パラメータ数チェック
     443/     283 : 3A A3 40            	LD A,(ARGC)
     444/     286 : FE 02               	CP 2
     445/     288 : 20 3A               	JR NZ,_PARAM_ERR
     446/     28A :                     ; 開始アドレス取得
     447/     28A : 2A A4 40            	LD HL,(ARGV_1)
     448/     28D : CD 6A 02            	CALL HEX4BIN
     449/     290 : 38 32               	JR C,_PARAM_ERR
     450/     292 : E5                  	PUSH HL
     451/     293 : DD E1               	POP IX
     452/     295 :                     ; 終了アドレス取得
     453/     295 : 2A A6 40            	LD HL,(ARGV_2)
     454/     298 : CD 6A 02            	CALL HEX4BIN
     455/     29B : 38 27               	JR C,_PARAM_ERR
     456/     29D : E5                  	PUSH HL
     457/     29E : D1                  	POP DE
     458/     29F : DD E5               	PUSH IX
     459/     2A1 : E1                  	POP HL
     460/     2A2 :                     ; ダンプ実施
     461/     2A2 :                     _DUMP_LOOP:
     462/     2A2 : DF                  	RST 18h
     463/     2A3 : 28 05               	JR Z,_DUMP_GO
     464/     2A5 : D7                  	RST 10h
     465/     2A6 : FE 1B               	CP ESC
     466/     2A8 : 28 20               	JR Z,_ABORT_DUMP
     467/     2AA :                     _DUMP_GO:
     468/     2AA : E5                  	PUSH HL
     469/     2AB : CD FB 02            	CALL DUMP16
     470/     2AE : E1                  	POP HL
     471/     2AF : CD D0 02            	CALL ASC16
     472/     2B2 : CD B4 01            	CALL CRLF_PRINT
     473/     2B5 :                     ; 終了判定
     474/     2B5 : 7A                  	LD A,D
     475/     2B6 : BC                  	CP H
     476/     2B7 : F8                  	RET M   ; メインループへ
     477/     2B8 : 7B                  	LD A,E
     478/     2B9 : BD                  	CP L
     479/     2BA : FA BF 02            	JP M,_DUMP_END_CHECK
     480/     2BD : 18 E3               	JR _DUMP_LOOP
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 9 - 2019/05/03 17時09分30秒


     481/     2BF :                     ;
     482/     2BF :                     _DUMP_END_CHECK:
     483/     2BF : 7A                  	LD A,D
     484/     2C0 : BC                  	CP H
     485/     2C1 : 20 DF               	JR NZ,_DUMP_LOOP
     486/     2C3 : C9                  	RET
     487/     2C4 :                     ;
     488/     2C4 :                     _PARAM_ERR:
     489/     2C4 : 21 DE 05            	LD HL,PARAM_ERRMSG
     490/     2C7 : C3 E6 01            	JP _PRINT_END
     491/     2CA :                     ;
     492/     2CA :                     _ABORT_DUMP:
     493/     2CA : 21 F1 05            	LD HL,ABORT_MSG
     494/     2CD : C3 E6 01            	JP _PRINT_END
     495/     2D0 :                     ;--------------------------------------------------------------------------------
     496/     2D0 :                     ; 16バイト分 ASCII出力
     497/     2D0 :                     ;--------------------------------------------------------------------------------
     498/     2D0 :                     ASC16:
     499/     2D0 : CD BB 01            	CALL SPC_PRINT
     500/     2D3 : 3E 3A               	LD A,':'
     501/     2D5 : CF                  	RST 08h
     502/     2D6 : CD BB 01            	CALL SPC_PRINT
     503/     2D9 : 0E 10               	LD C,10h
     504/     2DB :                     ;
     505/     2DB :                     _ASC16_LOOP:
     506/     2DB : 7E                  	LD A,(HL)
     507/     2DC : FE 20               	CP ' '
     508/     2DE : FA E6 02            	JP M,_ASC16_DOT
     509/     2E1 : FE 7F               	CP 7Fh
     510/     2E3 : FA E8 02            	JP M,_ASC16_PRINT
     511/     2E6 :                     _ASC16_DOT:
     512/     2E6 : 3E 2E               	LD A,'.'
     513/     2E8 :                     _ASC16_PRINT:
     514/     2E8 : CF                  	RST 08h	
     515/     2E9 : 23                  	INC HL
     516/     2EA : 0D                  	DEC C
     517/     2EB : C8                  	RET Z
     518/     2EC : 18 ED               	JR _ASC16_LOOP
     519/     2EE :                     
     520/     2EE :                     ;--------------------------------------------------------------------------------
     521/     2EE :                     ; アドレス部分出力
     522/     2EE :                     ;--------------------------------------------------------------------------------
     523/     2EE :                     ADDR_OUT:
     524/     2EE : CD F0 01            	CALL HEX4OUT
     525/     2F1 : CD BB 01            	CALL SPC_PRINT
     526/     2F4 : 3E 3A               	LD A,':'
     527/     2F6 : CF                  	RST 08h
     528/     2F7 : CD BB 01            	CALL SPC_PRINT
     529/     2FA : C9                  	RET
     530/     2FB :                     
     531/     2FB :                     ;--------------------------------------------------------------------------------
     532/     2FB :                     ; 16バイト分 HEXダンプ出力
     533/     2FB :                     ;--------------------------------------------------------------------------------
     534/     2FB :                     DUMP16:
     535/     2FB : CD EE 02            	CALL ADDR_OUT
     536/     2FE : 0E 10               	LD C,10h
     537/     300 :                     _DUMP16_LOOP:
     538/     300 : CD 0B 03            	CALL DUMP_AT
     539/     303 : CD BB 01            	CALL SPC_PRINT
     540/     306 : 23                  	INC HL
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 10 - 2019/05/03 17時09分30秒


     541/     307 : 0D                  	DEC C
     542/     308 : C8                  	RET Z
     543/     309 : 18 F5               	JR _DUMP16_LOOP
     544/     30B :                     
     545/     30B :                     ;--------------------------------------------------------------------------------
     546/     30B :                     ; 1バイト分 HEXダンプ出力
     547/     30B :                     ;--------------------------------------------------------------------------------
     548/     30B :                     DUMP_AT:
     549/     30B : 7E                  	LD A,(HL)
     550/     30C : CD BF 01            	CALL HEX2OUT
     551/     30F : C9                  	RET
     552/     310 :                     
     553/     310 :                     ;--------------------------------------------------------------------------------
     554/     310 :                     ; strlen
     555/     310 :                     ;--------------------------------------------------------------------------------
     556/     310 :                     STR_LEN:
     557/     310 : E5                  	PUSH HL
     558/     311 : C5                  	PUSH BC
     559/     312 : 0E 00               	LD C,0
     560/     314 :                     _STR_LEN_LOOP:
     561/     314 : 7E                  	LD A,(HL)
     562/     315 : FE 00               	CP NULL
     563/     317 : 28 04               	JR Z,_STR_LEN_EXIT
     564/     319 : 23                  	INC HL
     565/     31A : 0C                  	INC C
     566/     31B : 18 F7               	JR _STR_LEN_LOOP
     567/     31D :                     ;
     568/     31D :                     _STR_LEN_EXIT:
     569/     31D : 79                  	LD A,C
     570/     31E : C1                  	POP BC
     571/     31F : E1                  	POP HL
     572/     320 : C9                  	RET
     573/     321 :                     ;
     574/     321 :                     ;================================================================================
     575/     321 :                     ; メモリー変更コマンド
     576/     321 :                     ;================================================================================
     577/     321 :                     MEM_CHANGE:
     578/     321 : CD BB 01                CALL SPC_PRINT
     579/     324 :                     ;
     580/     324 : CD 48 01                CALL STRIN
     581/     327 : CD FB 01            	CALL PARSER
     582/     32A :                     ;
     583/     32A :                     ; 入力パラメータ数チェック
     584/     32A : 3A A3 40            	LD A,(ARGC)
     585/     32D : FE 01               	CP 1
     586/     32F : 20 93               	JR NZ,_PARAM_ERR
     587/     331 :                     ;
     588/     331 :                     ; 開始アドレス取得
     589/     331 : 2A A4 40            	LD HL,(ARGV_1)
     590/     334 : CD 6A 02            	CALL HEX4BIN
     591/     337 : 38 8B               	JR C,_PARAM_ERR
     592/     339 : E5                  	PUSH HL
     593/     33A : DD E1               	POP IX
     594/     33C :                     ;
     595/     33C : CD B4 01            	CALL CRLF_PRINT
     596/     33F :                     _MEM_CHANGE_LOOP:
     597/     33F : DD E5               	PUSH IX
     598/     341 : E1                  	POP HL
     599/     342 : CD EE 02            	CALL ADDR_OUT
     600/     345 : DD 7E 00            	LD A,(IX+0)
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 11 - 2019/05/03 17時09分30秒


     601/     348 : CD BF 01            	CALL HEX2OUT
     602/     34B : 3E 2D               	LD A,'-'
     603/     34D : CD AE 01            	CALL CPRINT
     604/     350 : DD E5               	PUSH IX
     605/     352 :                     ;
     606/     352 : CD 48 01                CALL STRIN
     607/     355 : DA 91 03            	JP C,_MEM_CHANGE_EXIT
     608/     358 : CD FB 01            	CALL PARSER
     609/     35B :                     ; 入力パラメータ数/レングスチェック
     610/     35B : 3A A3 40            	LD A,(ARGC)
     611/     35E : FE 00               	CP 0
     612/     360 : 28 1F               	JR Z,_NEXT_ADDR
     613/     362 : FE 01               	CP 1
     614/     364 : 20 21               	JR NZ,_HATENA_OUT
     615/     366 : 2A A4 40            	LD HL,(ARGV_1)
     616/     369 : CD 10 03            	CALL STR_LEN
     617/     36C : FE 02               	CP 2
     618/     36E : 20 17               	JR NZ,_HATENA_OUT
     619/     370 : 2A A4 40            	LD HL,(ARGV_1)
     620/     373 : CD 3D 02            	CALL HEX2BIN
     621/     376 : 38 0F               	JR C,_HATENA_OUT
     622/     378 : DD E1               	POP IX
     623/     37A : DD 77 00            	LD (IX+0),A
     624/     37D : DD 23               	INC IX
     625/     37F : 18 BE               	JR _MEM_CHANGE_LOOP
     626/     381 :                     ;
     627/     381 :                     _NEXT_ADDR:
     628/     381 : DD E1               	POP IX
     629/     383 : DD 23               	INC IX
     630/     385 : 18 B8               	JR _MEM_CHANGE_LOOP
     631/     387 :                     ;
     632/     387 :                     _HATENA_OUT:
     633/     387 : 21 1F 06            	LD HL,HATENA_MSG
     634/     38A : CD A5 01            	CALL STRPR
     635/     38D : DD E1               	POP IX
     636/     38F : 18 AE               	JR _MEM_CHANGE_LOOP
     637/     391 :                     ;
     638/     391 :                     _MEM_CHANGE_EXIT:
     639/     391 : DD E1               	POP IX
     640/     393 : CD B4 01            	CALL CRLF_PRINT
     641/     396 : C9                  	RET ;ESCキーでメイン処理へ
     642/     397 :                     
     643/     397 :                     ;
     644/     397 :                     ;================================================================================
     645/     397 :                     ; プログラム実行(G)コマンド
     646/     397 :                     ;================================================================================
     647/     397 :                     PGM_GO:
     648/     397 : CD BB 01                CALL SPC_PRINT
     649/     39A :                     ;
     650/     39A : CD 48 01                CALL STRIN
     651/     39D : CD FB 01            	CALL PARSER
     652/     3A0 :                     ;
     653/     3A0 :                     ; 入力パラメータ数チェック
     654/     3A0 : 3A A3 40            	LD A,(ARGC)
     655/     3A3 : FE 01               	CP 1
     656/     3A5 : C2 C4 02            	JP NZ,_PARAM_ERR
     657/     3A8 :                     ;
     658/     3A8 :                     _PGM_EXEC:
     659/     3A8 :                     ;
     660/     3A8 :                     ; 実行アドレス取得
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 12 - 2019/05/03 17時09分30秒


     661/     3A8 :                     ;
     662/     3A8 : 2A A4 40            	LD HL,(ARGV_1)
     663/     3AB : CD 10 03            	CALL STR_LEN
     664/     3AE : FE 04               	CP 4
     665/     3B0 : C2 C4 02            	JP NZ,_PARAM_ERR
     666/     3B3 :                     ;
     667/     3B3 : 2A A4 40            	LD HL,(ARGV_1)
     668/     3B6 : CD 6A 02            	CALL HEX4BIN
     669/     3B9 : DA C4 02            	JP C,_PARAM_ERR
     670/     3BC : E9                  	JP (HL)
     671/     3BD :                     ;
     672/     3BD :                     
     673/     3BD :                     ;
     674/     3BD :                     ;================================================================================
     675/     3BD :                     ; プログラム実行(Z)コマンド
     676/     3BD :                     ;================================================================================
     677/     3BD :                     ;
     678/     3BD :                     PGM_GO_PARAM:
     679/     3BD : CD BB 01                CALL SPC_PRINT
     680/     3C0 :                     ;
     681/     3C0 : CD 48 01                CALL STRIN
     682/     3C3 : CD FB 01            	CALL PARSER
     683/     3C6 :                     ;
     684/     3C6 :                     ; 入力パラメータ数チェック
     685/     3C6 : 3A A3 40            	LD A,(ARGC)
     686/     3C9 : FE 04               	CP 4
     687/     3CB : F2 C4 02            	JP P,_PARAM_ERR
     688/     3CE : C3 A8 03            	JP _PGM_EXEC
     689/     3D1 :                     ;
     690/     3D1 :                     ;================================================================================
     691/     3D1 :                     ; I/O入力コマンド
     692/     3D1 :                     ;================================================================================
     693/     3D1 :                     IO_IN:
     694/     3D1 : CD BB 01                CALL SPC_PRINT
     695/     3D4 :                     ;
     696/     3D4 : CD 48 01                CALL STRIN
     697/     3D7 : CD FB 01            	CALL PARSER
     698/     3DA :                     ;
     699/     3DA :                     ; 入力パラメータ数チェック
     700/     3DA : 3A A3 40            	LD A,(ARGC)
     701/     3DD : FE 01               	CP 1
     702/     3DF : C2 C4 02            	JP NZ,_PARAM_ERR
     703/     3E2 :                     ;
     704/     3E2 :                     ; I/Oアドレス取得
     705/     3E2 : 2A A4 40            	LD HL,(ARGV_1)
     706/     3E5 : CD 10 03            	CALL STR_LEN
     707/     3E8 : FE 02               	CP 2
     708/     3EA : C2 C4 02            	JP NZ,_PARAM_ERR
     709/     3ED :                     ;
     710/     3ED : 2A A4 40            	LD HL,(ARGV_1)
     711/     3F0 : CD 3D 02            	CALL HEX2BIN
     712/     3F3 : DA C4 02            	JP C,_PARAM_ERR
     713/     3F6 : 4F                  	LD C,A
     714/     3F7 : ED 78               	IN A,(C)
     715/     3F9 :                     ;
     716/     3F9 : CD BF 01            	CALL HEX2OUT
     717/     3FC : CD B4 01            	CALL CRLF_PRINT
     718/     3FF : C9                  	RET
     719/     400 :                     ;
     720/     400 :                     ;================================================================================
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 13 - 2019/05/03 17時09分30秒


     721/     400 :                     ; I/O出力コマンド
     722/     400 :                     ;================================================================================
     723/     400 :                     IO_OUT:
     724/     400 : CD BB 01                CALL SPC_PRINT
     725/     403 :                     ;
     726/     403 : CD 48 01                CALL STRIN
     727/     406 : CD FB 01            	CALL PARSER
     728/     409 :                     ;
     729/     409 :                     ; 入力パラメータ数チェック
     730/     409 : 3A A3 40            	LD A,(ARGC)
     731/     40C : FE 02               	CP 2
     732/     40E : C2 C4 02            	JP NZ,_PARAM_ERR
     733/     411 :                     ;
     734/     411 :                     ; I/Oアドレス取得
     735/     411 : 2A A4 40            	LD HL,(ARGV_1)
     736/     414 : CD 10 03            	CALL STR_LEN
     737/     417 : FE 02               	CP 2
     738/     419 : C2 C4 02            	JP NZ,_PARAM_ERR
     739/     41C :                     ;
     740/     41C : 2A A4 40            	LD HL,(ARGV_1)
     741/     41F : CD 3D 02            	CALL HEX2BIN
     742/     422 : DA C4 02            	JP C,_PARAM_ERR
     743/     425 : 4F                  	LD C,A
     744/     426 :                     ;
     745/     426 :                     ; 出力データ取得
     746/     426 : 2A A6 40            	LD HL,(ARGV_2)
     747/     429 : CD 10 03            	CALL STR_LEN
     748/     42C : FE 02               	CP 2
     749/     42E : C2 C4 02            	JP NZ,_PARAM_ERR
     750/     431 :                     ;
     751/     431 : 2A A6 40            	LD HL,(ARGV_2)
     752/     434 : CD 3D 02            	CALL HEX2BIN
     753/     437 : DA C4 02            	JP C,_PARAM_ERR
     754/     43A :                     ;
     755/     43A : ED 79               	OUT (C),A
     756/     43C :                     ;
     757/     43C : CD B4 01            	CALL CRLF_PRINT
     758/     43F : C9                  	RET
     759/     440 :                     ;================================================================================
     760/     440 :                     ; インテルHEXロードコマンド
     761/     440 :                     ;================================================================================
     762/     440 :                     LOAD:
     763/     440 : CD B4 01            	CALL CRLF_PRINT
     764/     443 :                     ;
     765/     443 :                     _LOAD_START:
     766/     443 : D7                  	RST 10h
     767/     444 : FE 1B               	CP ESC
     768/     446 : 28 48               	JR Z,_LOAD_EXIT
     769/     448 : FE 3A               	CP ':'
     770/     44A : 20 F7               	JR NZ,_LOAD_START
     771/     44C : CF                  	RST 08h
     772/     44D :                     ;
     773/     44D :                     ; LENGTH GET
     774/     44D : 06 00               	LD B,0
     775/     44F : CD 48 01                CALL STRIN
     776/     452 :                     ;
     777/     452 : 21 66 40            	LD HL,INBUF
     778/     455 : CD 3D 02            	CALL HEX2BIN
     779/     458 : 4F                  	LD C,A
     780/     459 : 47                  	LD B,A
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 14 - 2019/05/03 17時09分30秒


     781/     45A :                     ;
     782/     45A :                     ; ADDR GET
     783/     45A : 21 68 40            	LD HL,INBUF+2
     784/     45D : CD 6A 02            	CALL HEX4BIN
     785/     460 : E5                  	PUSH HL
     786/     461 : DD E1               	POP IX
     787/     463 : 78                  	LD A,B
     788/     464 : 84                  	ADD A,H
     789/     465 : 85                  	ADD A,L
     790/     466 : 47                  	LD B,A
     791/     467 :                     ;
     792/     467 :                     ; GET RECORD TYPE
     793/     467 : 21 6C 40            	LD HL,INBUF+6
     794/     46A : CD 3D 02            	CALL HEX2BIN
     795/     46D : B7                  	OR A
     796/     46E : 20 20               	JR NZ,_LOAD_EXIT
     797/     470 :                     ;
     798/     470 :                     _MEM_LOAD_START:
     799/     470 : 21 6E 40            	LD HL,INBUF+8
     800/     473 :                     _MEM_LOAD:
     801/     473 : CD 3D 02            	CALL HEX2BIN
     802/     476 : DD 77 00            	LD (IX+0),A
     803/     479 : 80                  	ADD A,B
     804/     47A : 47                  	LD B,A
     805/     47B : 23                  	INC HL
     806/     47C : DD 23               	INC IX
     807/     47E : 0D                  	DEC C
     808/     47F : 20 F2               	JR NZ,_MEM_LOAD
     809/     481 :                     ;
     810/     481 : CD 3D 02            	CALL HEX2BIN
     811/     484 : 80                  	ADD A,B
     812/     485 : B7                  	OR A
     813/     486 : 20 02               	JR NZ,_CHECKSUM_ERROR
     814/     488 : 18 B9               	JR _LOAD_START
     815/     48A :                     ;
     816/     48A :                     _CHECKSUM_ERROR:
     817/     48A : 21 0B 06            	LD HL,CHECKSUM_ERRMSG
     818/     48D : C3 E6 01            	JP _PRINT_END
     819/     490 :                     ;
     820/     490 :                     _LOAD_EXIT:
     821/     490 : C9                  	RET
     822/     491 :                     ;
     823/     491 :                     ;--------------------------------------------------------------------------------
     824/     491 :                     ; コマンドテーブル
     825/     491 :                     ;--------------------------------------------------------------------------------
     826/     491 :                     CMD_TBL:
     827/     491 : 48                      DB 'H'
     828/     492 : DC 01                   DW HELP_OUT
     829/     494 : 3F                      DB '?'
     830/     495 : DC 01                   DW HELP_OUT
     831/     497 : 56                      DB 'V'
     832/     498 : E1 01                   DW VERSION_OUT
     833/     49A : 44                      DB 'D'
     834/     49B : 78 02                   DW MEM_DUMP
     835/     49D : 4D                      DB 'M'
     836/     49E : 21 03                   DW MEM_CHANGE
     837/     4A0 : 47                      DB 'G'
     838/     4A1 : 97 03                   DW PGM_GO
     839/     4A3 : 5A                      DB 'Z'
     840/     4A4 : BD 03                   DW PGM_GO_PARAM
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 15 - 2019/05/03 17時09分30秒


     841/     4A6 : 49                      DB 'I'
     842/     4A7 : D1 03                   DW IO_IN
     843/     4A9 : 4F                      DB 'O'
     844/     4AA : 00 04                   DW IO_OUT
     845/     4AC : 4C                      DB 'L'
     846/     4AD : 40 04                   DW LOAD
     847/     4AF : =>UNDEFINED           IFDEF KZ80
     848/     4AF :                         DB 'X'
     849/     4AF :                         DW CPMLOAD
     850/     4AF : [847]                 ENDIF
     851/     4AF :                     ; TABLE END
     852/     4AF : 00                      DB 00h
     853/     4B0 :                     ;
     854/     4B0 :                     ;--------------------------------------------------------------------------------
     855/     4B0 :                     ; メッセージなど
     856/     4B0 :                     ;--------------------------------------------------------------------------------
     857/     4B0 : =KUNI-NET Z8..      VERNAME EQU "KUNI-NET Z80 MONITOR v0.6"
     858/     4B0 : 4B 55 4E 49 2D 4E   VERMSG  DB VERNAME,CR,0
                    45 54 20 5A 38 30 
                    20 4D 4F 4E 49 54 
                    4F 52 20 76 30 2E 
                    36 0D 00 
     859/     4CB : 0D 0D 2A 2A 20 4B   OPENMSG DB CR,CR,"** ",VERNAME," **",CR,0
                    55 4E 49 2D 4E 45 
                    54 20 5A 38 30 20 
                    4D 4F 4E 49 54 4F 
                    52 20 76 30 2E 36 
                    20 2A 2A 0D 00 
     860/     4EE : 08 20 08 00         BSTXT	DB BS,SPC,BS,0
     861/     4F2 : 2D 20 2D 20 2D 20   HELP_MSG DB "- - - COMMAND HELP - - -",CR
                    43 4F 4D 4D 41 4E 
                    44 20 48 45 4C 50 
                    20 2D 20 2D 20 2D 
                    0D 
     862/     50B : 4D 20 58 58 58 58            DB "M XXXX ",TAB,TAB,"MEMORY EDIT",CR
                    20 09 09 4D 45 4D 
                    4F 52 59 20 45 44 
                    49 54 0D 
     863/     520 : 44 20 58 58 58 58            DB "D XXXX XXXX ",TAB,"MEMORY DUMP",CR
                    20 58 58 58 58 20 
                    09 4D 45 4D 4F 52 
                    59 20 44 55 4D 50 
                    0D 
     864/     539 : 47 20 58 58 58 58            DB "G XXXX",TAB,TAB,"PROGRAM EXECUTE",CR
                    09 09 50 52 4F 47 
                    52 41 4D 20 45 58 
                    45 43 55 54 45 0D 
     865/     551 : 5A 20 58 58 58 58            DB "Z XXXX PARAM1 PARAM2",TAB,"PROGRAM EXECUTE w/PARAM",CR
                    20 50 41 52 41 4D 
                    31 20 50 41 52 41 
                    4D 32 09 50 52 4F 
                    47 52 41 4D 20 45 
                    58 45 43 55 54 45 
                    20 77 2F 50 41 52 
                    41 4D 0D 
     866/     57E : 49 20 58 58 09 09            DB "I XX",TAB,TAB,"I/O INPUT",CR
                    49 2F 4F 20 49 4E 
                    50 55 54 0D 
     867/     58E : 4F 20 58 58 20 58            DB "O XX XX",TAB,TAB,"I/O OUTPUT",CR
                    58 09 09 49 2F 4F 
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 16 - 2019/05/03 17時09分30秒


                    20 4F 55 54 50 55 
                    54 0D 
     868/     5A2 : 4C 20 09 09 49 4E            DB "L ",TAB,TAB,"INTEL HEX LOAD",CR
                    54 45 4C 20 48 45 
                    58 20 4C 4F 41 44 
                    0D 
     869/     5B5 : 48 20 09 09 48 45            DB "H ",TAB,TAB,"HELP MESSGAE",CR
                    4C 50 20 4D 45 53 
                    53 47 41 45 0D 
     870/     5C6 : 56 20 09 09 56 45            DB "V ",TAB,TAB,"VERSION INFOMATION",CR,0
                    52 53 49 4F 4E 20 
                    49 4E 46 4F 4D 41 
                    54 49 4F 4E 0D 00 
     871/     5DE : 07 2A 2A 20 50 41   PARAM_ERRMSG DB BEEP,"** PARAMETER ERR",CR,0
                    52 41 4D 45 54 45 
                    52 20 45 52 52 0D 
                    00 
     872/     5F1 : 07 2A 2A 20 4D 45   ABORT_MSG DB BEEP,"** MEM DUMP ABORTED END",CR,0
                    4D 20 44 55 4D 50 
                    20 41 42 4F 52 54 
                    45 44 20 45 4E 44 
                    0D 00 
     873/     60B : 07 2A 2A 20 43 48   CHECKSUM_ERRMSG DB BEEP,"** CHECKSUM ERROR",CR,0
                    45 43 4B 53 55 4D 
                    20 45 52 52 4F 52 
                    0D 00 
     874/     61F : 0D 3F 0D 00         HATENA_MSG DB CR,"?",CR,0
     875/     623 :                     
     876/     623 :                     ;
     877/     623 :                     ;
     878/     623 :                     ;------------------------------------------------------------------------------
     879/     623 :                     ; デバイス依存ルーチン (deviceディレクトリに配置)
     880/     623 :                     ;------------------------------------------------------------------------------
     881/     623 : =>UNDEFINED         	IFDEF MC6850
     882/     623 :                     	  include "device/KZ80_6850.asm"
     883/     623 : [881]               	ENDIF
     884/     623 :                     
     885/     623 : =>UNDEFINED         	IFDEF SBC8080SUB
     886/     623 :                     	  include "device/SBC8080SUB.asm" 
     887/     623 : [885]               	ENDIF
     888/     623 :                     
     889/     623 : =>UNDEFINED         	IFDEF KZ80
     890/     623 :                     	  include "device/KZ80_8251.asm"
     891/     623 : [889]               	ENDIF
     892/     623 :                     
     893/     623 : =>DEFINED           	IFDEF i8259_8254
     894/     623 :                     	  include "device/KZ80_8259_8254.asm"
(1)    1/     623 :                     ;
(1)    2/     623 :                     ; KZ80_IOBv2用 モジュール
(1)    3/     623 :                     ;    割り込み  8259
(1)    4/     623 :                     ;    タイマー  8254
(1)    5/     623 :                     ;    シリアル　8251x1
(1)    6/     623 :                     ;    パラレル  8255x1
(1)    7/     623 :                     ;--------------------------------------------------------
(1)    8/     623 :                     ; 以下のルーチンはSBC8080データパックのASMソースを参考にさせていただきました。
(1)    9/     623 :                     ;  SERINT 	8251シリアル割り込みルーチン
(1)   10/     623 :                     ;  CIN		シリアル1文字入力ルーチン
(1)   11/     623 :                     ;  COUT		シリアル1文字出力ルーチン
(1)   12/     623 :                     ;  CKINCHAR	シリアルバッファチェックルーチン
(1)   13/     623 :                     
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm(KZ80_8259_8254.asm) - page 17 - 2019/05/03 17時09分30秒


(1)   14/     623 : =0H                 UARTRD	EQU	00H
(1)   15/     623 : =1H                 UARTRC	EQU	01H
(1)   16/     623 :                     ;
(1)   17/     623 : =10H                PICRC	EQU	10h
(1)   18/     623 : =11H                PICRD	EQU	11h
(1)   19/     623 :                     ;
(1)   20/     623 : =18H                PIT_C0	EQU 18h
(1)   21/     623 : =19H                PIT_C1	EQU 19h
(1)   22/     623 : =1AH                PIT_C2	EQU 1Ah
(1)   23/     623 : =1BH                PIT_CWR	EQU 1Bh
(1)   24/     623 :                     ;
(1)   25/     623 : =7530H              PIT_TIMER_INIT EQU 30000
(1)   26/     623 :                     ;
(1)   27/     623 :                     ;
(1)   28/     623 : =3FH                BUFSIZ	EQU	3FH
(1)   29/     623 : =30H                BUFFUL	EQU	30H
(1)   30/     623 : =5H                 BUFEMP	EQU	5
(1)   31/     623 :                     ;
(1)   32/     623 : =17H                RTSHIG	EQU	00010111B
(1)   33/     623 : =37H                RTSLOW	EQU	00110111B
(1)   34/     623 :                     
(1)   35/     623 :                     ;------------------------------------------------------------------------------
(1)   36/     623 :                     ; 8251割り込みルーチン
(1)   37/     623 :                     ;------------------------------------------------------------------------------
(1)   38/     623 : F5                  SERINT:	PUSH	AF
(1)   39/     624 : E5                  	PUSH	HL
(1)   40/     625 : DB 01               	IN	A,(UARTRC)
(1)   41/     627 : E6 02               	AND	00000010B
(1)   42/     629 : CA 5D 06            	JP	Z,RTS0
(1)   43/     62C : DB 00               	IN	A,(UARTRD)
(1)   44/     62E : F5                  	PUSH	AF
(1)   45/     62F : 3A 65 40            	LD	A,(SERCNT)
(1)   46/     632 : FE 3F               	CP	BUFSIZ
(1)   47/     634 : C2 3B 06            	JP	NZ,NOTFUL
(1)   48/     637 : F1                  	POP	AF
(1)   49/     638 : C3 5D 06            	JP	RTS0
(1)   50/     63B : 2A 61 40            NOTFUL:	LD	HL,(SERINP)
(1)   51/     63E : 23                  	INC	HL
(1)   52/     63F : 7D                  	LD	A,L
(1)   53/     640 : FE 61               	CP	SERINP & 0FFH
(1)   54/     642 : C2 48 06            	JP	NZ,NOTWRP
(1)   55/     645 : 21 22 40            	LD	HL,SERBUF
(1)   56/     648 : 22 61 40            NOTWRP:	LD	(SERINP),HL
(1)   57/     64B : F1                  	POP	AF
(1)   58/     64C : 77                  	LD	(HL),A
(1)   59/     64D : 3A 65 40            	LD	A,(SERCNT)
(1)   60/     650 : 3C                  	INC	A
(1)   61/     651 : 32 65 40            	LD	(SERCNT),A
(1)   62/     654 : FE 30               	CP	BUFFUL
(1)   63/     656 : DA 5D 06            	JP	C,RTS0
(1)   64/     659 : 3E 17               	LD	A,RTSHIG
(1)   65/     65B : D3 01               	OUT	(UARTRC),A
(1)   66/     65D :                     RTS0:
(1)   67/     65D : 3E 20               	LD A,00100000b
(1)   68/     65F : D3 10               	OUT (PICRC),A	
(1)   69/     661 : E1                  	POP	HL
(1)   70/     662 : F1                  	POP	AF
(1)   71/     663 :                     
(1)   72/     663 : FB                  	EI
(1)   73/     664 : C9                  	RET
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm(KZ80_8259_8254.asm) - page 18 - 2019/05/03 17時09分30秒


(1)   74/     665 :                     
(1)   75/     665 :                     ;------------------------------------------------------------------------------
(1)   76/     665 :                     ; 1文字入力(バッファから)
(1)   77/     665 :                     ;------------------------------------------------------------------------------
(1)   78/     665 :                     CIN:
(1)   79/     665 : 3A 65 40            	LD	A,(SERCNT)
(1)   80/     668 : FE 00               	CP	00H
(1)   81/     66A : CA 65 06            	JP	Z,CIN
(1)   82/     66D : E5                  	PUSH	HL
(1)   83/     66E : 2A 63 40            	LD	HL,(SERRDP)
(1)   84/     671 : 23                  	INC	HL
(1)   85/     672 : 7D                  	LD	A,L
(1)   86/     673 : FE 61               	CP	SERINP & 0FFH
(1)   87/     675 : C2 7B 06            	JP	NZ,NRWRAP
(1)   88/     678 : 21 22 40            	LD	HL,SERBUF
(1)   89/     67B : F3                  NRWRAP:	DI
(1)   90/     67C : 22 63 40            	LD	(SERRDP),HL
(1)   91/     67F : 3A 65 40            	LD	A,(SERCNT)
(1)   92/     682 : 3D                  	DEC	A
(1)   93/     683 : 32 65 40            	LD	(SERCNT),A
(1)   94/     686 : FE 05               	CP	BUFEMP
(1)   95/     688 : D2 8F 06            	JP	NC,RTS1
(1)   96/     68B : 3E 37               	LD	A,RTSLOW
(1)   97/     68D : D3 01               	OUT	(UARTRC),A
(1)   98/     68F : 7E                  RTS1:	LD	A,(HL)
(1)   99/     690 : FB                  	EI
(1)  100/     691 : E1                  	POP	HL
(1)  101/     692 : C9                  	RET	
(1)  102/     693 :                     
(1)  103/     693 :                     ;------------------------------------------------------------------------------
(1)  104/     693 :                     ; 1文字出力
(1)  105/     693 :                     ;------------------------------------------------------------------------------
(1)  106/     693 : F5                  COUT:		PUSH	AF
(1)  107/     694 : DB 01               COUT1:	IN	A,(UARTRC)
(1)  108/     696 : E6 01               	AND	01H     
(1)  109/     698 : CA 94 06            	JP	Z,COUT1
(1)  110/     69B : F1                  	POP	AF
(1)  111/     69C : D3 00               	OUT	(UARTRD),A
(1)  112/     69E : C9                  	RET
(1)  113/     69F :                     
(1)  114/     69F :                     ;------------------------------------------------------------------------------
(1)  115/     69F :                     ; 入力バッファチェック
(1)  116/     69F :                     ;------------------------------------------------------------------------------
(1)  117/     69F : 3A 65 40            CKINCHAR	LD	A,(SERCNT)
(1)  118/     6A2 : FE 00               	CP	00H
(1)  119/     6A4 : C9                  	RET
(1)  120/     6A5 :                     
(1)  121/     6A5 :                     ;------------------------------------------------------------------------------
(1)  122/     6A5 :                     ; PIT 8254 割り込み処理
(1)  123/     6A5 :                     ;------------------------------------------------------------------------------
(1)  124/     6A5 :                     ; PIT1
(1)  125/     6A5 :                     INT_VECTOR4_RTN:
(1)  126/     6A5 : F5                  	PUSH AF
(1)  127/     6A6 : E5                  	PUSH HL
(1)  128/     6A7 : CD CE 06            	CALL PIT_C1_INIT
(1)  129/     6AA : 18 05               	JR PIT_INT_EXIT
(1)  130/     6AC :                     ; PIT0
(1)  131/     6AC :                     INT_VECTOR5_RTN:
(1)  132/     6AC : F5                  	PUSH AF
(1)  133/     6AD : E5                  	PUSH HL
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm(KZ80_8259_8254.asm) - page 19 - 2019/05/03 17時09分30秒


(1)  134/     6AE : CD C0 06            	CALL PIT_C0_INIT
(1)  135/     6B1 :                     ;
(1)  136/     6B1 :                     PIT_INT_EXIT:
(1)  137/     6B1 : 3E 20               	LD A,00100000b
(1)  138/     6B3 : D3 10               	OUT (PICRC),A
(1)  139/     6B5 : E1                  	POP HL
(1)  140/     6B6 : F1                  	POP AF
(1)  141/     6B7 : FB                  	EI
(1)  142/     6B8 : C9                  	RET
(1)  143/     6B9 :                     ;------------------------------------------------------------------------------
(1)  144/     6B9 :                     ; PIT 8254 初期化
(1)  145/     6B9 :                     ;------------------------------------------------------------------------------
(1)  146/     6B9 :                     PIT_INIT:
(1)  147/     6B9 :                     ; COUNTER INIT 
(1)  148/     6B9 : CD C0 06            	CALL PIT_C0_INIT
(1)  149/     6BC : CD CE 06            	CALL PIT_C1_INIT
(1)  150/     6BF : C9                  	RET
(1)  151/     6C0 :                     ;
(1)  152/     6C0 :                     ; PIT TIMER SET
(1)  153/     6C0 :                     ;
(1)  154/     6C0 :                     PIT_C0_INIT:
(1)  155/     6C0 : 2A 20 40            	LD HL,(TIMER_COUNT)
(1)  156/     6C3 : 3E 30               	LD A,00110000b
(1)  157/     6C5 : D3 1B               	OUT (PIT_CWR),A
(1)  158/     6C7 : 7C                  	LD A,H
(1)  159/     6C8 : D3 18               	OUT (PIT_C0),A
(1)  160/     6CA : 7D                  	LD A,L
(1)  161/     6CB : D3 18               	OUT (PIT_C0),A
(1)  162/     6CD : C9                  	RET
(1)  163/     6CE :                     ;
(1)  164/     6CE :                     PIT_C1_INIT:
(1)  165/     6CE : 2A 20 40            	LD HL,(TIMER_COUNT)
(1)  166/     6D1 : 3E 70               	LD A,01110000b
(1)  167/     6D3 : D3 1B               	OUT (PIT_CWR),A
(1)  168/     6D5 : 7C                  	LD A,H
(1)  169/     6D6 : D3 19               	OUT (PIT_C1),A
(1)  170/     6D8 : 7D                  	LD A,L
(1)  171/     6D9 : D3 19               	OUT (PIT_C1),A
(1)  172/     6DB : C9                  	RET
(1)  173/     6DC :                     
(1)  174/     6DC :                     ;------------------------------------------------------------------------------
(1)  175/     6DC :                     ; 初期化
(1)  176/     6DC :                     ;------------------------------------------------------------------------------
(1)  177/     6DC :                     INIT:		
(1)  178/     6DC : 31 CA 40                LD  SP,STACK
(1)  179/     6DF :                     ; Intrrupt VECTOR SET
(1)  180/     6DF : 21 1D 07            	LD HL,HOOKAREA
(1)  181/     6E2 : 11 00 40            	LD DE,RST00HOOK
(1)  182/     6E5 : 01 20 00            	LD BC,32
(1)  183/     6E8 : ED B0               	LDIR
(1)  184/     6EA :                     ;
(1)  185/     6EA : 21 22 40            	LD	HL,SERBUF
(1)  186/     6ED : 22 61 40            	LD	(SERINP),HL
(1)  187/     6F0 : 22 63 40            	LD	(SERRDP),HL
(1)  188/     6F3 : AF                  	XOR	A
(1)  189/     6F4 : 32 65 40            	LD	(SERCNT),A
(1)  190/     6F7 : D3 01               	OUT	(UARTRC),A
(1)  191/     6F9 : D3 01               	OUT	(UARTRC),A
(1)  192/     6FB : D3 01               	OUT	(UARTRC),A
(1)  193/     6FD : 3E 40               	LD	A,01000000B
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm(KZ80_8259_8254.asm) - page 20 - 2019/05/03 17時09分30秒


(1)  194/     6FF : D3 01               	OUT	(UARTRC),A
(1)  195/     701 : 3E 4E               	LD	A,01001110B
(1)  196/     703 : D3 01               	OUT	(UARTRC),A
(1)  197/     705 : 3E 37               	LD	A,RTSLOW
(1)  198/     707 : D3 01               	OUT	(UARTRC),A
(1)  199/     709 :                     ;
(1)  200/     709 :                     ; 8259 INIT
(1)  201/     709 : 3E 12               	LD A,00010010b
(1)  202/     70B : D3 10               	OUT (PICRC),A
(1)  203/     70D : AF                  	XOR A
(1)  204/     70E : D3 11               	OUT (PICRD),A
(1)  205/     710 :                     ; 
(1)  206/     710 :                     ; 8254 INIT
(1)  207/     710 : 21 30 75            	LD HL,PIT_TIMER_INIT
(1)  208/     713 : 22 20 40            	LD (TIMER_COUNT),HL
(1)  209/     716 : CD B9 06            	CALL PIT_INIT
(1)  210/     719 :                     ;
(1)  211/     719 : FB                  	EI
(1)  212/     71A :                     ;
(1)  213/     71A : C3 00 01                JP MAIN
(1)  214/     71D :                     ;
(1)  215/     71D :                     ;------------------------------------------------------------------------------
(1)  216/     71D :                     HOOKAREA: 
(1)  217/     71D :                     ; RST00
(1)  218/     71D : C3                  	DB 0C3h
(1)  219/     71E : DC 06               	DW INIT
(1)  220/     720 : 00                  	DB 00H
(1)  221/     721 :                     ; RST08
(1)  222/     721 : C3                  	DB 0C3h
(1)  223/     722 : 93 06               	DW COUT
(1)  224/     724 : 00                  	DB 00H
(1)  225/     725 :                     ; RST10
(1)  226/     725 : C3                  	DB 0C3h
(1)  227/     726 : 65 06               	DW CIN
(1)  228/     728 : 00                  	DB 00H
(1)  229/     729 :                     ; RST18
(1)  230/     729 : C3                  	DB 0C3h
(1)  231/     72A : 9F 06               	DW CKINCHAR
(1)  232/     72C : 00                  	DB 00H
(1)  233/     72D :                     ; RST20
(1)  234/     72D : C3                  	DB 0C3h
(1)  235/     72E : A5 06               	DW INT_VECTOR4_RTN
(1)  236/     730 : 00                  	DB 00H
(1)  237/     731 :                     ; RST28
(1)  238/     731 : C3                  	DB 0C3h
(1)  239/     732 : AC 06               	DW INT_VECTOR5_RTN
(1)  240/     734 : 00                  	DB 00H
(1)  241/     735 :                     ; RST30
(1)  242/     735 : C3                  	DB 0C3h
(1)  243/     736 : 00 00               	DW 0000h
(1)  244/     738 : 00                  	DB 00H
(1)  245/     739 :                     ; RST38
(1)  246/     739 : C3                  	DB 0C3h
(1)  247/     73A : 23 06               	DW SERINT
(1)  248/     73C : 00                  	DB 00H
(1)  249/     73D :                     ;
(1)  250/     73D : =73DH               DEVICE_END EQU $
(1)  251/     73D :                     ;
(1)  252/     73D :                     ; KZ80-1MSRAM用 RAM 4000h〜
(1)  253/     73D :                     ;
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm(KZ80_8259_8254.asm) - page 21 - 2019/05/03 17時09分30秒


(1)  254/    4000 :                         ORG 4000h
(1)  255/    4000 :                     ;
(1)  256/    4000 :                     
(1)  257/    4000 :                     ;
(1)  258/    4000 :                     RST00HOOK DS 4
(1)  259/    4004 :                     RST08HOOK DS 4
(1)  260/    4008 :                     RST10HOOK DS 4
(1)  261/    400C :                     RST18HOOK DS 4
(1)  262/    4010 :                     RST20HOOK DS 4
(1)  263/    4014 :                     RST28HOOK DS 4
(1)  264/    4018 :                     RST30HOOK DS 4
(1)  265/    401C :                     RST38HOOK DS 4
(1)  266/    4020 :                     ;
(1)  267/    4020 :                     TIMER_COUNT DS 2
(1)  268/    4022 :                     ;
(1)  269/    4022 :                     SERBUF	DS	BUFSIZ
(1)  270/    4061 :                     SERINP	DS	2
(1)  271/    4063 :                     SERRDP	DS	2
(1)  272/    4065 :                     SERCNT	DS	1
(1)  273/    4066 :                     ;
(1)  274/    4066 : =4066H              DEVICE_RAM_END EQU $
(1)  275/    4066 :                     
(1)  276/    4066 :                     
     895/    4066 : [893]               	ENDIF
     896/    4066 :                     
     897/    4066 :                     
     898/    4066 :                     ;
     899/    4066 :                     ;------------------------------------------------------------------------------
     900/    4066 :                     ; RAM バッファ & STACK
     901/    4066 :                     ;------------------------------------------------------------------------------
     902/    4066 :                     	ORG DEVICE_RAM_END
     903/    4066 :                     ;
     904/    4066 :                     INBUF   DS  60
     905/    40A2 : =3CH                INMAX   EQU  $-INBUF
     906/    40A2 :                     INEND   DS  1
     907/    40A3 :                     ;
     908/    40A3 :                     ARGC	DS	1
     909/    40A4 :                     ARGV_1	DS	2
     910/    40A6 :                     ARGV_2	DS	2
     911/    40A8 :                     ARGV_3	DS	2
     912/    40AA : =3H                 ARG_MAX	EQU ($-ARGV_1)/2
     913/    40AA : =7H                 ARG_AREA_LEN EQU $-ARGC
     914/    40AA :                     ;
     915/    40AA :                         	DS	32
     916/    40CA : =40CAH              STACK   EQU $
     917/    40CA :                     
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 22 - 2019/05/03 17時09分30秒


  symbol table (* = unused):
  ------------------------

 ABORT_MSG :                    5F1 C |  ADDR_OUT :                     2EE C |
*ARCHITECTURE :    x86_64-apple-osx - |  ARGC :                        40A3 C |
 ARGV_1 :                      40A4 C |  ARGV_2 :                      40A6 C |
*ARGV_3 :                      40A8 C |  ARG_AREA_LEN :                   7 - |
 ARG_MAX :                        3 - |  ASC16 :                        2D0 C |
 BEEP :                           7 - | *BIGENDIAN :                      0 - |
*BRANCHEXT :                      0 - |  BS :                             8 - |
 BSTXT :                        4EE C |  BUFEMP :                         5 - |
 BUFFUL :                        30 - |  BUFSIZ :                        3F - |
*CASESENSITIVE :                  0 - |  CHECKSUM_ERRMSG :              60B C |
 CIN :                          665 C |  CKINCHAR :                     69F C |
*CLS :                            C - |  CMD_TBL :                      491 C |
*CONSTPI :        3.141592653589793 - |  COUT :                         693 C |
 COUT1 :                        694 C |  CPRINT :                       1AE C |
 CR :                             D - |  CRLF_PRINT :                   1B4 C |
*CTRLC :                          3 - | *DATE :                  2019/05/03 - |
 DEL :                           7F - | *DEVICE_END :                   73D - |
 DEVICE_RAM_END :              4066 - |  DUMP16 :                       2FB C |
 DUMP_AT :                      30B C |  ESC :                           1B - |
*FALSE :                          0 - | *FULLPMMU :                       1 - |
 GETC :                         13E C | *HAS64 :                          1 - |
*HASDSP :                         0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - |  HATENA_MSG :                   61F C |
 HELP_MSG :                     4F2 C |  HELP_OUT :                     1DC C |
 HEX2BIN :                      23D C |  HEX2OUT :                      1BF C |
 HEX4BIN :                      26A C |  HEX4OUT :                      1F0 C |
 HOOKAREA :                     71D C | *I8259_8254 :                     1 - |
 INBUF :                       4066 C |  INEND :                       40A2 C |
*INEXTMODE :                      0 - |  INIT :                         6DC C |
*INLWORDMODE :                    0 - |  INMAX :                         3C - |
*INMAXMODE :                      0 - | *INSRCMODE :                      0 - |
*INSUPMODE :                      0 - |  INT_VECTOR4_RTN :              6A5 C |
 INT_VECTOR5_RTN :              6AC C |  IO_IN :                        3D1 C |
 IO_OUT :                       400 C | *LF :                             A - |
*LISTON :                         1 - |  LOAD :                         440 C |
*MACEXP :                         7 - |  MAIN :                         100 C |
 MEM_CHANGE :                   321 C |  MEM_DUMP :                     278 C |
*MOMCPU :                        80 - | *MOMCPUNAME :                   Z80 - |
*NESTMAX :                      100 - |  NOTFUL :                       63B C |
 NOTWRP :                       648 C |  NRWRAP :                       67B C |
 NULL :                           0 - |  OPENMSG :                      4CB C |
*PACKING :                        0 - | *PADDING :                        1 - |
 PARAM_ERRMSG :                 5DE C |  PARSER :                       1FB C |
 PGM_GO :                       397 C |  PGM_GO_PARAM :                 3BD C |
 PICRC :                         10 - |  PICRD :                         11 - |
 PIT_C0 :                        18 - |  PIT_C0_INIT :                  6C0 C |
 PIT_C1 :                        19 - |  PIT_C1_INIT :                  6CE C |
*PIT_C2 :                        1A - |  PIT_CWR :                       1B - |
 PIT_INIT :                     6B9 C |  PIT_INT_EXIT :                 6B1 C |
 PIT_TIMER_INIT :              7530 - | *RELAXED :                        0 - |
*RST00 :                          0 C |  RST00HOOK :                   4000 C |
*RST08 :                          8 C |  RST08HOOK :                   4004 C |
*RST10 :                         10 C |  RST10HOOK :                   4008 C |
*RST18 :                         18 C |  RST18HOOK :                   400C C |
*RST20 :                         20 C |  RST20HOOK :                   4010 C |
*RST28 :                         28 C |  RST28HOOK :                   4014 C |
*RST30HOOK :                   4018 C | *RST38 :                         38 C |
 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 23 - 2019/05/03 17時09分30秒


 RST38HOOK :                   401C C |  RTS0 :                         65D C |
 RTS1 :                         68F C |  RTSHIG :                        17 - |
 RTSLOW :                        37 - |  SERBUF :                      4022 C |
 SERCNT :                      4065 C |  SERINP :                      4061 C |
 SERINT :                       623 C |  SERRDP :                      4063 C |
 SPC :                           20 - |  SPC_PRINT :                    1BB C |
 STACK :                       40CA - |  STRIN :                        148 C |
 STRPR :                        1A5 C |  STR_LEN :                      310 C |
 TAB :                            9 - |
*TIME :                          17\-26\-10\-1209\-27\-12\-1230\-25\-89\-11 - |
 TIMER_COUNT :                 4020 C | *TRUE :                           1 - |
 UARTRC :                         1 - |  UARTRD :                         0 - |
 VERMSG :                       4B0 C |
 VERNAME :                                        KUNI-NET Z80 MONITOR v0.6 - |
*VERSION :                     142F - |  VERSION_OUT :                  1E1 C |
 _ABORT_DUMP :                  2CA C |  _ASC16_DOT :                   2E6 C |
 _ASC16_LOOP :                  2DB C |  _ASC16_PRINT :                 2E8 C |
 _ATOBIN :                      257 C |  _ATOBIN1 :                     267 C |
 _BS_RTN :                      189 C |  _BS_RTN2 :                     194 C |
 _CHAR_SET :                    17B C |  _CHECKSUM_ERROR :              48A C |
 _CMD_LOOP :                    115 C |  _DUMP16_LOOP :                 300 C |
 _DUMP_END_CHECK :              2BF C |  _DUMP_GO :                     2AA C |
 _DUMP_LOOP :                   2A2 C |  _ERROR_EXIT :                  130 C |
 _ESC_RTN :                     187 C |  _HATENA_OUT :                  387 C |
 _HEX2BIN_EXIT :                255 C |  _HEX_CNV_PR :                  1D4 C |
 _LOAD_EXIT :                   490 C |  _LOAD_START :                  443 C |
 _MAIN_LOOP :                   106 C |  _MEM_CHANGE_EXIT :             391 C |
 _MEM_CHANGE_LOOP :             33F C |  _MEM_LOAD :                    473 C |
*_MEM_LOAD_START :              470 C |  _NEXT_ADDR :                   381 C |
 _NEXT_CMD :                    128 C |  _PARAM_ERR :                   2C4 C |
 _PARAM_LOOP :                  22D C |  _PARSE_ERR :                   23B C |
 _PARSE_LOOP :                  211 C |  _PGM_EXEC :                    3A8 C |
 _PRINT_END :                   1E6 C |  _STRIN_END :                   1A1 C |
 _STRIN_LOOP :                  15B C |  _STR_LEN_EXIT :                31D C |
 _STR_LEN_LOOP :                314 C |  _WARN_BEEP :                   182 C |

    180 symbols
     44 unused symbols

 AS V1.42 Beta [Bld 137] - source file Z80mon.asm - page 24 - 2019/05/03 17時09分30秒


  codepages:
  ----------

STANDARD (0 changed characters)


0.02 seconds assembly time

   1193 lines source file
      2 passes
      0 errors
      0 warnings
